---
- name: Install wpasupplicant
  apt:
    name: wpasupplicant
    state: latest
  become: True


- name: Restrict Network Interface Configuration
  file:
    path: /etc/network/interfaces
    mode: 0600
  become: True


- name: Configure Network systemd Unit
  copy:
    src: files/networking.service
    dest: /lib/systemd/system/networking.service
  become: True
  register: networking_unit


- name: Reload Network systemd Unit
  systemd:
    name: networking.service
    state: restarted
    daemon_reload: True
  become: True
  when: networking_unit.changed


- name: Configure Network Resume systemd Unit
  copy:
    src: files/networking_resume.service
    dest: /lib/systemd/system/networking_resume.service
  become: True
  register: networking_resume_unit


- name: Reload Network Reload systemd Unit
  systemd:
    name: networking_resume.service
    enabled: True
    daemon_reload: True
  become: True
  when: networking_resume_unit.changed


- name: Configure WPA Supplicant File
  copy:
    src: files/wpa_supplicant.conf
    dest: /etc/wpa_supplicant/wpa_supplicant.conf
  become: True
  register: wpa_supplicant


- name: Restrict WPA Supplicant File
  file:
    path: /etc/wpa_supplicant/wpa_supplicant.conf
    mode: 0600
  become: True


- name: Configure Network Interface
  copy:
    src: files/interfaces
    dest: /etc/network/interfaces
  become: True


- name: Configure DHCP Client
  copy:
    src: files/dhclient.conf
    dest: /etc/dhcp/dhclient.conf
  become: True
